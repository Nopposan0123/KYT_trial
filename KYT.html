<!DOCTYPE html>
<html lang="ja">
<head>
    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
    <title>画像クリックで注意表示</title>
    <style>

    body {
      margin: 0 auto;
      font-family: "Avenir Next";
      display:flex;
    }
    
    .wrap-sub1{
      width: 25%;
      text-align: left;
      background-color: lemonchiffon;
    }

    .wrap-main{
      width: 75%;
      background-color: rgb(239, 247, 239);
      display:flex;
    }

    .header{
	  background-image: url('forest.jpg');
	  background-color: #26d0b1;
      border:4px solid rgb(182, 222, 38);
      color: white;
      width:59.5%;
      height:34px;
      position: fixed;
      display:flex;
    }

    .process-work {
      background-color: #b0e4f7;
      user-select: auto;
      margin-top: 0px;
      padding:0px;
      font-size: 7px;
	  color: black;
      float:left;
      width:32%;
    }

    .display{
        background-color: rgb(239, 247, 239);
    }

    .hidden{
        display: none;
    }
        #imageContainer {
            position: relative;
            display: inline-block;
        }
        #mainImage {
            width: 600px; /* 画像の表示サイズ */
        }
        .note-box {
            position: absolute;
            background-color: yellow;
            padding: 5px;
            border: 1px solid #ccc;
            display: none;
        }

        #coords {
            position: absolute;
            background-color: rgba(255, 255, 0, 0.9);
            padding: 4px 8px;
            border: 1px solid #ccc;
            font-size: 14px;
            pointer-events: none;
        }
    </style>
</head>
<body>

<wrap class="wrap-main">
    <div class="header">
        <select id="work1", name="select">
		  <option value="19">--作業を選択してください--</option>
          <option value="1">重量物の設置・移動</option>
          <option value="9">階段昇降・梯子昇降</option>
          <option value="8">歩行・移動</option>
          <option value="11">高所作業</option>
          <option value="2">洗浄・清掃作業</option>
        </select>
    	  
        &nbsp <input id="button1" type="button" onclick=next() value="次の場面">

        &nbsp <input type="button" value="前の場面" onclick=previous()>

        &nbsp <button id="button2" onclick="reloadPage(event)">リセット</button>
	 
    </div>   

    <div class="display">
        <br>
      <h2>&nbsp画像をクリックして注意点はどこか確認しよう</h2>
      <div id="imageContainer">
        <img src="Safety.jpg" alt="サンプル画像" id="mainImage">
        <div id="note" class="note-box"></div>
        <div id="coords"></div>
      </div>
    </div>

    <div class="display">
      <br>
      <h2>場面</h2>
      <p id="outline" style="font-size:20px">&nbsp危険予知を習慣にしよう</p>
      <p id="pn" style="font-size:30px;  color: red"></p>
      <br>
      <br>
      <br>
      <h2>危険予知アドバイス</h2>
      <p id="advice1"></p>
      <p id="advice2"></p>
    </div>

<audio id="coinSound" src="correct.mp3" preload="auto"></audio>
<audio id="perfect" src="perfect1.mp3" preload="auto"></audio>

</wrap>

<wrap1 class="wrap-sub1">
    <h2>得点</h2>
    <p id="miles" style="font-size:20px">&nbsp 0miles</p>
    <p id="status" style="font-size:40px;  color: blue">Let's try!</p>
    <p id="po0" class = "hidden"></p>
    <p id="po1" class = "hidden"></p>
    <p id="po2" class = "hidden"></p>
    <p id="po3" class = "hidden"></p>
    <p id="po4" class = "hidden"></p>
    <p id="po5" class = "hidden"></p>
    <p id="po6" class = "hidden"></p>
    <p id="po7" class = "hidden"></p>
    <p id="po8" class = "hidden"></p>
    <p id="po9" class = "hidden"></p>

</wrap1>

<script>
 //収録データ
const database=[
    ["1_ky0","2人で重たい机を移動させる作業を行っている。",[["1)腰痛に注意",[35,170,88,240]],["2)腰痛に注意",[435,130,470,190]],["3)机の脚に挟まれ注意",[110,415,150,460]],["4)机の脚に挟まれ注意",[405,370,440,395]],["5)配線に躓き注意",[365,425,555,505]],["6)引き出しが開く事に注意",[130,250,425,365]],["7)肩を痛めないように注意",[40,110,110,170]],["8)肩を痛めないように注意",[385,65,470,110]],"",""]],
    ["9_ky0","2人が階段を上り、下りしている。",[["1)手すりを持つ",[165,95,210,160]],["2)足下に注意",[195,230,310,335]],["3)足下に注意",[275,355,436,445]],["4)ポケットに手を入れて歩かない",[343,265,455,325]],["5)ぼんやりして歩かない",[365,127,465,230]],["6)危ない行動をしている人には注意を伝えよう",[211,30,276,117]],"","","",""]],
    ["8_ky0","2人が歩行している。",[["1)フォークリフトに注意",[345,35,455,190]],["2)ポケットに手を入れて歩かない",[250,175,295,195]],["3)蓋が外れていることに注意",[415,270,495,310]],["4)トラックの動きに注意",[485,120,595,215]],["5)足下に注意",[245,240,300,265]],["6)足下に注意",[295,220,380,260]],"","","",""]],
    ["11_ky0","事務所の安全ブレーカーを取り替えている。",[["1)キャスター付き椅子を踏み台に使わない",[210,315,325,385]],["2)感電に注意",[165,15,235,65]],["3)ドアから人が入ってくることに注意",[300,55,455,340]],["4)工具は適切な場所に置く",[145,380,250,440]],"","","","","",""]],
    ["2_ky0","トイレの清掃中、急な連絡が入り持場を離れることになり、別の作業者が引き継ぎで掃除の続きをしようとしています。",[["1)足下が滑ることに注意",[30,330,220,425]],["2)ボトルを元に戻す",[235,255,340,300]],["3)デッキブラシを元に戻す",[270,345,560,430]],["4)ホースを元に戻す",[320,95,420,390]],["5)バケツを元に戻す",[440,270,520,350]],"","","","",""]]
]

var KY_advices1=[
["回転機器は少しでも巻き込まれると体を破壊するまで動き続ける事を認識せよ", "SOPは安全を確保するための教科書である事を認識して作業せよ", "手出し作業は原則禁止、巻き込まれのリスクが高いことを認識せよ", "速度が遅い機器に対する油断により、巻込まれが多く発生している事を認識せよ", "多くの機器は瞬時に止まる事ができない事を認識せよ", "手間がかかっても安全優先、咄嗟の行動は労災を招く事を認識せよ", "手が容易に入る箇所がないか、今一度確認せよ", "シャフトを無理やり手で作業すると、手や指を挟むリスクが高くなる。無理せず、設備担当者に相談せ", "咄嗟の行動は労災を招く、咄嗟に手が出そうな箇所を点検せよ", "装置を稼働させるときは共同作業者が何処にいるか声掛け・確認せよ", "ロールの清掃作業は原則設備停止して実施、ロール回転が遅くても、巻き込まれてヘルメットと共に頭を割った事例がある事を認識せよ", "作業エリアでない所は想定していないリスク有り、適切な道具を使い、手順書を遵守して作業せよ", "回転動機器の近くでの作業は危険。十分安全な距離を決めて、それより遠くで作業しよう。"],
["作業経験が浅い人には、作業の手順と挟まれの危険個所を周知せよ", "重量物を不安定な状態で置くと転倒の危険あり、静置状態を確認せよ", "二人以上での作業時は、「声を掛け合う」「相手の動きや状況を確認する」を習慣をつけよ", "設備の重い部品を取り外す作業の際には、落下防止治具を使用する等の対策をせよ", "重量物を手で移動させる際は、転倒する可能性がある段差、突起物がないか確認せよ", "重量物を吊って移動させる際は、手を挟まない位置で作業する事を意識せよ", "重い物を移動させるときは、無理な力が掛からないよう作業姿勢に気をつけよ", "重量物を移動させるときは、作業足場を確保せよ", "重いものを肩の高さまで持ち上げる作業は、肩を痛める危険があります。適切な高さに調整せよ。","動かしているものから飛び出してくるものが無いか確認しよう"],
["細かい樹脂片の上は滑りやすく、中には鋭利な樹脂片もあることを認識して作業せよ", "高所の清掃作業においては、枠組み足場又はローディング足場を使用せよ", "設備の一部にはバリがある可能性があることを認識し、バリを発見したら直ぐバリ取りせよ", "ロールの清掃作業は原則設備停止して実施、ロール回転が遅くても、巻き込まれてヘルメットと共に頭を割った事例がある事を認識せよ", "稼働中の装置には手をだすな、停止させてから対応せよ", "無理な姿勢での清掃作業は事故を招きます。作業方法や装備の見直しをしよう。", "適切な保護具を着用しましょう", "清掃作業を行う時は、清掃する物質の有害性を確認せよ", "清掃時、物を動かすときは突起物等が無いか確認しよう"],
["狭い装置内部は突起物がある事を認識し、ヘルメットを着用せよ", "ロールの清掃作業は原則設備停止して実施、ロール回転が遅くても、巻き込まれてヘルメットと共に頭を割った事例がある事を認識せよ,", "作業前に作業エリア周辺に突起物が無いか確認せよ", "作業が完了しても気を緩めず、周りに突起物等ないか確認せよ", "無理な体勢で行う作業には腰痛・骨折のリスク有り、準備運動と共に作業方法の見直しせよ"],
["異常が発生した場合は、咄嗟に行動をせず、先ず設備を停止せよ", "足ふみスイッチ等で装置を動かし始める前に、自分と共同作業者が安全な状態である事を確認せよ", "残反の処理方法を確認し、明確でない場合は手順書で明確にせよ", "点検作業中でも、動いたら挟まれる箇所に手や体が触れていないか意識せよ", "シャフトとチャックに挟まれる事例が多いことを認識し、動作・構造を理解せよ", "トラブル或いは誤操作で異常が発生した場合、落ち着いて設備を止めて対応せよ", "動機器は見かけ上、停止して見える事もある。作業場所が可動範囲であるか、設備は停止しているか、確認してから作業を行おう。", "二人作業は、相方の状態を確認しながら作業しよう。特に、相方が未熟な場合、丁寧に確認しながら作業を進めよう。", "作業場所が動機器の可動範囲であるか、設備は停止しているか、確認してから作業を行おう。", "作業手順は守るもの。正しい作業手順を確認せよ。", "作業手順には意味がある。何故、その様な手順であるか理解して作業しよう。"],
["ハサミを持って共同作業者に近づくと、相手を傷つける虞あり、ハサミも刃物である事を認識せよ", "ハサミ等の刃物を一時的に使わない場合でも、所定の場に置くことを心がけよ", "ケブラ手袋をしていても切創事故は起こる可能性がある事を認識せよ"],
["刃物の交換時は、必ず保護手袋を着用せよ", "刃物に少し触れただけでも切創災害に繋がる事を意識し、保護手袋を着用せよ", "装置は確実に止め、保護手袋を着用して作業せよ", "設備内の刃物に触れるかもしれないと意識し、適切な保護具を着用して作業せよ", "近道行為は労災に繋がる事を認識し、作業手順を遵守せよ", "保護手袋を着用していても、大きな力で刃に触れると切創に繋がることを認識し、油断せず作業せよ", "これくらいなら問題ないと思う事が労災を招く事を認識し、安全対策を行った上で対応せよ", "作業エリアでない所は想定していないリスク有り、適切な道具を使い、手順書を遵守して作業せよ", "ケブラ手袋をしていても切創事故は起こる可能性がある事を認識せよ"],
["刃物の交換時は、必ず保護手袋を着用せよ", "刃物に少し触れただけでも切創災害に繋がる事を意識し、保護手袋を着用せよ", "装置は確実に止め、保護手袋を着用して作業せよ", "設備内の刃物に触れるかもしれないと意識し、適切な保護具を着用して作業せよ", "近道行為は労災に繋がる事を認識し、作業手順を遵守せよ", "保護手袋を着用していても、大きな力で刃に触れると切創に繋がることを認識し、油断せず作業せよ", "これくらいなら問題ないと思う事が労災を招く事を認識し、安全対策を行った上で対応せよ", "作業エリアでない所は想定していないリスク有り、適切な道具を使い、手順書を遵守して作業せよ", "ケブラ手袋をしていても切創事故は起こる可能性がある事を認識せよ"],
["床が滑りやすい状態となっていると早歩きでも転倒事故に繋がる、滑りやすい箇所が無いか確認せよ", "靴の裏に水分が残っていると滑りやすくなるので、十分に拭き取る", "小走りでの移動は転倒・衝突の危険有り、急いでいても、落ち着いて歩行せよ", "ピットや溝の蓋を開けた状態にする必要が有る時は、落下防止策等の対策をせよ", "ちょっとした突起でも転倒の危険あり、突起は無くすよう対策せよ", "通路以外は原則通行禁止、転倒・激突の危険がある事を認識せよ", "製造現場には危険が潜んでいる事を意識し、目の前、足元、頭上に注意して歩行せよ", "通路に物を置くと躓く危険あり。作業動線に干渉する場合は、その場所に注意喚起の表示をせよ", "やむを得ず排水桝や溝を開放する場合は、転落防止措置を講じてください。"],
["階段での労災が多いことを意識し、手すりは必ず掴む", "階段を利用するときは、手すりをつかめるように少なくとも片手を空けてください。", "2、3段でも踏み外してしまう危険があるので、足元に注意しましょう", "たとえ手すりを持っていても転倒をする恐れがあります。特に降りる時は注意してください。", "急いでいても、階段は駆け降りず、1段づつ正しく使用せよ,梯子を下りる際は、地面に降りるまで気を緩めない", "階段を使う時は足元の段差に注意し、手すりを必ず持って昇降せよ", "階段での転倒が多いことを意識し、油断せず足もとを注意、３点支持（手摺持ち）せよ", "ステップのストッパー、階段の滑り止めに異常が有る時は、転落等の危険があるため直ぐに修理せよ", "急いでいる場合でも、階段を駆け下りたりせず、各段を正しく利用してください。"],
["ボルトの変形、レンチヘッドの損傷が無いか確認せよ", "六角レンチの柄にパイプを組み合わせてネジを緩める作業は禁止。トルクレンチ或いは柄の長いものを使用し、スカされない様注意せよ", "六角レンチがボルトに適切に挿入した事を確認してから、ボルトを緩めよ", "専用でない工具を使うと、設備の破損だけでなく、予期せぬ労災が発生する危険あり、適切な工具を使用せよ", "トラブル発生時の対応等、非定常作業を行う時は、作業手順書でどの様な危険があるか確認する。"],
["高所の清掃作業においては、枠組み足場又はローディング足場を使用せよ", "設備の梁、ダクト等は作業するために設計されていないため転落、踏み外しのリスク有り、専用の踏み台等の検討をせよ", "不安定な物の上で作業は厳禁、専用の踏み台を使用せよ", "高所(1m以上)且つ足場のない場所での作業は転落のリスク高い、作業法・設備を改善せよ", "高所での安全を確保し、無理な姿勢を避けましょう", "労働災害の多くは階段を降りるときに発生しています。足元を確認しよう。", "落下防止策を講じずに高所で作業することは禁止されています。高所で作業する場合は必ず安全ベルトを着用してください。", "高所では転倒防止策を講じ、無理な姿勢にならないように注意してください", "高所にある不安定な足場は落下の危険があります。しっかりした足場で作業せよ", "高所の清掃作業においては、枠組み足場又はローディング足場を使用せよ", "脚立のストッパーの掛かりが甘いと動くことがある。ストッパーの状態を確認してから作業を行おう。", "地下への開口部は、高所と同等となるので、落下防止対策をせよ。"],
["グラインダーの持ち方、力の入れ方を再確認せよ", "皮手袋等の滑り難い保護手袋、通し面を着用せよ"],
["レベル計等、感電する可能性がある箇所を認識して作業せよ", "レベル計等、感電する可能性がある箇所を認識して作業せよ", "作業手順には安全に作業できるように作られている。手順通りの作業を行おう。"],
["電気設備の再立ち上げを行う時は、設備の配線・仕様を確認し、地絡等が発生しないように注意せよ", "決められた手順で電源を入れても設備が作動しない場合は、異常があると判断し、専門家に相談せよ"],
["衝突、挟まれのリスク有り、ドアはゆっくり開け閉めせよ", "閉まりかけのドアは挟まれのリスク有り、一旦ドアが閉まってから開けよ", "開け閉めが難しいドアは、衝突、挟まれのリスク有り、改善せよ"],
["配管作業を行うときは、高温の液体等の配管を把握し、縁切りを行って作業せよ", "老朽化した設備には腐食している部分がある事を意識して作業しよう。"],
["フォークリフトの'つめ'を上げたままにすると躓きの危険がある事を認識せよ", "フォークリフトでバックする時は、必ず後方確認せよ", "フォークリフトでの作業でパレットに躓くことが多いことを認識し、パレットの置き場所を最適化せよ", "フォークリフトで人に衝突したら重大事故になる事を認識し、制限速度を遵守せよ", "パレット上にドラム缶を並べる際は、ドラム缶の隙間にはさまれないように注意してください。"],
["ストランド切れの時は、ストランド引きを行なわない、SOPを遵守して作業せよ、併せて、適切な保護具を検討せよ", "配管作業を行うときは、高温の液体等の配管を把握し、縁切りを行って作業せよ"],
["Dummy", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
["つり上げるもののバランスを考えて作業せよ", "挟まれる可能性があるところに手を置いていないか確認せよ", "クレーン車のアウトリガーは可動するので足をかけない", "クレーン操作者と補助作業は常に声を掛け合って作業せよ", "クレーンを操作する際は、挟まれる可能性がある場所を意識せよ"],
["解体作業では、配管に残液がないか十分に確認せよ", "重量物を撤去するときは、無理な体勢にならないように対策をせよ", "高所でのボルト取り外しは、安定した足場を確保せよ", "老朽化した設備には腐食している部分がある事を意識して作業しよう。"],
["作業前に発火等のトラブル発生時の対応を確認せよ", "設備のエッジ部はバリ等で鋭くなっている箇所があるの注意せよ"],
["作業前にマンホールの中に有害物がないことを確認せよ", "窒素雰囲気の塔槽類のマンホールを開放するときは、完全に空気に置換された事が確認できるまで立ち入り禁止。"],
["コンクリート側面調整はつりには、チッパーを使用する", "手間がかかっても、安全に適切な作業ができる工具を使用せよ"],
["作業経験が浅い人には、作業の手順と挟まれの危険個所を周知せよ", "重量物を不安定な状態で置くと転倒の危険あり、静置状態を確認せよ", "二人以上での作業時は、「声を掛け合う」「相手の動きや状況を確認する」を習慣をつけよ", "クレーン操作者と補助作業は常に声を掛け合って作業せよ", "作業で使用する装置がトラブルを起こした時の対処法を確認せよ", "クレーンを操作する際は、挟まれる可能性がある場所を意識せよ", "設備の重い部品を取り外す作業の際には、落下防止治具を使用する等の対策をせよ", "重量物を手で移動させる際は、転倒する可能性がある段差、突起物がないか確認せよ", "重量物を吊って移動させる際は、手を挟まない位置で作業する事を意識せよ", "重い物を移動させるときは、無理な力が掛からないよう作業姿勢に気をつけよ", "重量物を移動させるときは、作業足場を確保せよ", "パレット上にドラム缶を並べる際は、ドラム缶の隙間にはさまれないように注意してください。", "重いものを肩の高さまで持ち上げる作業は、肩を痛める危険があります。適切な高さに調整せよ。"],
["溶接作業時は、溶融物が跳ねることを想定して適切な保護具、作業服を着用せよ", "溶接の作業手順を遵守せよ", "溶接作業前に肌の露出が無いか再度確認しよう"],
["ガラス器具を使用する時は、傷、ひび等が入っていないか確認し、適切な保護具を着用せよ。", "ガラス器具は壊れやすいものと認識し、安全な取扱い方法を確認して作業しよう。", "ガラス器具を扱う時は、壊れやすい部分を意識して作業しよう。", "適切な管径或いは材質の耐圧ｺﾞﾑﾎｰｽを選択し、ｶﾞﾗｽ製実験器具には過度の力を加えない。"],
["作業前に加熱する物質の物性、危険有害性を確認せよ", "突沸しないように適切な作業手順を確認せよ", "加熱しているものは熱くなっている事を意識しよう"],
["設備の構造を理解してから作業せよ", "刃物を使う必要が出た場合は、適切な保護具を着用せよ", "樹脂硬化にUVを使う場合、直接、目、肌にUVが当たらないように保護具を着用せよ", "成型する樹脂に関する感作性についても確認せよ"],
["バルブを操作する前に、関係する他のバルブの状態を確認せよ。", "作業終了時は、バルブが適切な状態になっている事を確認せよ。", "常温で気体である成分に対して、内容物が噴き出す可能性が無いか確認せよ"],
["可燃性物質を取り扱う場合は、接地や流量制限などの静電気対策を講じ、爆発限界外の窒素雰囲気下で作業してください。", "配管内の液抜き作業時に残液が溢れる可能性を想定し、非定常作業指示書を作成してください。", "フランジを開ける際は、残液が飛び出す可能性を想定して、手前にあるボルトから緩めてください。", "微加圧状態でホースで液体を排出する場合は、ホースに一気に圧力がかからないようバルブの操作手順を確認してください。", "液抜き用バルブを操作する前に、元バルブから移送先までのライン（バルブの開閉状態）を直接確認してください。", "作業を変更した場合は、再度危険予知を行い、安全が確保されるまで作業者を近づけないようにしてください。", "オーバーフローが発生した場合の対処方法を事前に確認してから作業を行ってください。", "非定常作業を行う場合は、必ず次のシフトに引き継いでください。", "P&IDで配管の流れを理解し、設備の危険箇所を認識して作業を行いましょう", "熱膨張により封入されている液体が噴出する恐れがありますので、事前に液体を取り除いて下さい。", "ポンプを始動する前に、バルブの開閉状態を確認し、液体にさらされる危険を排除してください。", "送液に使用するタイゴンチューブは定期的に交換してください。", "適切な工具や材料を準備してから、手順書に従って作業を開始してください", "液体を移送するときは、暴露のリスクを最小限に抑える方法に注意してください (適切な保護具を着用する)", "移送中の容器が溢れる危険性を想定し、容器の状態を確認する", "フレキシブルホースが擦れなどによる損傷から保護されていることを確認してください。", "危険な作業が重なった場合、重大な労働災害が発生する恐れがあります。作業の進め方については、事前に関係者と協議してください。", "有毒な蒸気を吸入すると健康に危険を及ぼす可能性があります。 適切な保護具を着用してください"],
["火災警報器をきちんと確認する,定期的に点検すべき設備を確認してください", "無理な姿勢での作業は事故を招きます。作業方法や設備を見直しましょう", "機器の振動は思わぬ破損やトラブルの原因となります。直ちに確認し、対策を講じてください。", "故障した設備を発見した場合は、直ちに関係者に報告し修理してください。"],
["扱っている物質の危険性と毒性情報を確認してください", "無理な姿勢は事故につながる可能性があります。高さなどを調整して適切な姿勢を確保せよ", "サンプリング作業には被液する危険が伴います。適切な保護具を着用してください", "サンプルボトルにラベルが付いていることを確認してください"],
["電源投入時はケーブルの状態を確認し、ショートの可能性がないか確認してください。", "電源を入れる時は、作業をしない、機器に手を触れない"],
["高所での安全を確保し、無理な姿勢にならないように注意せよ。", "バルブ操作で手が滑った場合を想定して、周りを状況を確認せよ", "バルブを操作する前に、関係する他のバルブの状態を確認せよ", "無理な姿勢にならないように注意せよ", "狭いスペースでの作業は、周囲の設備と激突しないか確認せよ", "高所では墜落防止対策をとり、無理な姿勢とならないよう気をつけよ。", "足が滑る、手が滑る、よろける等、不測の事態を想定し、ぶつかる可能性がある箇所を確認せよ", "無理な姿勢でのバルブ操作は被液のリスク有り。足場の確保を行い、保護具の着用を実施せよ。", "バルブを操作する前に、関係する他のバルブの状態を確認せよ。", "作業終了時は、バルブが適切な状態になっている事を確認せよ。"],
["包装機による包装作業中は静電気が発生するので注意し、周囲に可燃物がないことを確認してください。", "包装機が稼働している時は、巻込まれないように、包装機に近づかない"],
["PH 紙で検査する場合は、適切な保護具を着用してください", "作業前に、取り扱う物質の危険有害性を確認して下さい"],
["作業を始める前に、取り扱う化学物質の危険有害性情報を確認してください。", "内容物に間違いがないか、ドラムに添付しているラベルを確認せよ。"],
["作業前にウォーミングアップや体調チェックをし、疲れる前に休憩をとりましょう", "原材料を手作業で投入する場合は、原材料への接触や液体への暴露の危険を最小限に抑えるため、容器や袋に亀裂、破れ、その他の異常がないことを確認してください。", "廃棄物中の危険物質との接触のリスクを最小限に抑えるために、保護眼鏡を着用してください。", "SDSにより、作業で取り扱う物質の危険性を認識し、手順書に従って適切な保護具を着用してください。"],
["固相原料投入作業NaSH固相原料投入後に洗浄を行わないと、残ったNaSHに触れる可能性があります。清掃を行ってください。", "作業手順を確認して作業しよう"]
];

var KY_advices2=[
["慣れた作業でも操作の見直し・確認せよ", "緊急の時こそ、確実に作業手順を遵守せよ", "ちょっとした段差にもリスクあり、足場の確認せよ", "普段動かないと思うものが、もし動いたらどうなるか想定して行動せよ", "急ぎの時程、一息入れて安全確認せよ", "保護メガネ着用時に隙間が無いか確認せよ", "詰まりを放置することにリスクあり、改善できないか相談せよ", "装置更新等の変更時は思わぬ危険が潜んでいるので要注意", "装置が予想外の動きをしたときは、落ち着いて装置を停止させて対応せよ", "終業まで油断せず、近道行為はしない。指差し呼称して、意識レベルを高めよう", "焦っている時こそ、落ち着いて決まった手順を守ろう", "いつもの作業にも見落としがあるかもしれない。ヒヤリとしたら考えてみよう。", "多くの動機器は、直ぐには止まらない。特性を理解してから作業を行おう。", "設備をよく見て異常がないことを確認する習慣を付けよう。", "慣れた作業でも、常に気づいていない危険がないか確認しよう。", "保護具着用していても、気を緩めずに作業しよう。", "作業は安全なものと思い込まず、どうしたら怪我する可能性があるか想定し、その可能性をつぶしてから作業を行おう。", "現地、現場を確認して行動・判断しよう。", "共同作業の場合は、手順、相手の状態を確認しながら行おう。", "動きが遅くても、巻き込まれたら重大な労災となる。動機器に触れる時は、装置を必ず止めるようにしよう。", "次に何が起こるか想定して作業を行う。", "反復作業のように見えても状況は刻一刻と変わる。一動作ずつ状況に応じた作業をせよ。", "低速でも巻き込まれたら災害となる。動いている機器には手を出さない。", "今まで無事故の作業でも、リスクアセスメントを定期的に行い、リスクレベルを下げよう。", "止まっている様に見えても、もし動いたらどうなるかを想定する。動機器に触れる時は、電源を必ず落とす。", "いかなる状況でも、安全は全てに優先する。安全を確保して作業を実施せよ。", "段差の傍を通るのは引っ掛かることがあるので危険。作業場の配置を見直して安全な歩行経路を確保しよう。", "省略行為は予想外の事態につながる。一つ一つ確実に、本来行うべき手順・確認を実行しよう。", "保護具を着用していても、事故が起こる可能性は有る。保護具を過信しない。", "作業を早く済まそうとして、近道行為をすることは危険。全ての確認を行ってから作業をしよう。", "慣れた作業を惰性で進めるのは危険。省略せずにひとつひとつ確認しながら進めよう。"],
["急ぎの時程、一息入れて安全確認せよ", "労災が起きると自分だけでなく他の人も不幸になる。安全が最優先を心がけよ", "動きが遅くても人の体を破壊するのに十分な力がある事を認識せよ", "安全のための時間や手間は必要な事。近道行為は事故を招く", "緊急の時こそ、確実に作業手順を確認せよ", "焦っているときは、周りに相談、無理なく作業を進めよ", "自分だけは大丈夫と思う心にリスクあり、今一度、無理な作業をしていないか見直し", "分かったふりが事故を起こす。分からない事は確実に周りに相談せよ", "安全最優先、先ず安全確保をせよ", "危険の放置は事故を招く、安全を優先し、まず上司に相談しよう", "低速で動いている動機器に巻き込まれる事例が多い事を認識し、稼働中の動機器には絶対触れない。", "自分の体力を過信すると、思わぬ事故につながる。無理な力が必要な作業は、作業方法を見直ししよう。", "危険だと思う作業が有るときは、作業・設備の見直しを行おう。", "安全装置を外して作業する行為は、原則禁止。安全装置を外す行為は、危険源をむき出しにする事と心得よ。", "ゆっくり動く回転体・設備は、人を油断させ巻き込まれる事例が多い事を認識せよ。", "重いものを扱う作業は繰り返すとダメージを受けることとがある。今一度作業方法を見直そう。", "ベテランでもミスは犯す。省略行為をせずに基本に忠実に行動しよう。", "安全が全てに優先する事を認識し、危険な作業はしない、させない。", "異常発生は、いろいろな場合がある。上司、専門部隊と相談してから対応しよう。", "惰性で行動をすることは危険、状況を認識してから行動しよう。", "保護カバーを過信すると、大きな事故を招く。保護カバーが機能しない場合を想定して行動せよ。", "同時に二つの作業を行うとどちらもおろそかになり危険な場多になりうる。一つずつの作業をしよう。", "慌てて省略行為をして作業すると危険な状態となり、結果的にロスとなる。落ち着いて手順書通りの作業を行おう。"],
["守れないルール・SOPがある場合は、先ず上司へ相談せよ", "労災が起きると自分だけでなく他の人も不幸になる。安全が最優先を心がけよ", "作業エリア外は危険が高い、立ち入るな", "SOPは安全を確実にするための手順。独自の方法では安全が抜けるリスクあり", "何故複数人なのかを理解し、作業手順を遵守せよ", "作業手順書が実作業に合っていないときは、まず上司に相談し作業手順書を修正せよ", "ちょっとした手出しが災害を招く、設備を停止させて対応せよ", "適正な治具・道具を使って作業せよ", "NTカッターは原則使用禁止、刃物に触れる可能性が有る時はケブラー手袋を着用せよ", "近道行為は厳禁、時間をかけても、安全を優先せよ", "慌てているときこそ、禁止行動がなぜ禁止されているかもう一度確認しよう。", "作業手順を無視すると、思いがけない事故を招く。今まで事故が無い事は、将来の安全を保証するものではない事を認識せよ。", "自分だけは大丈夫と思う心が事故を招く。保護具の着用基準を理解してから作業にとりかかろう。", "食事休憩前に慌てる事で事故が起きることが多い。近道行為は禁止、作業手順を順守しよう。", "過去の教訓からルールは出来ている。ルール違反をするとリスクが高くなる事を意識せよ。", "時間がかかっても、手順に則り作業を行おう。", "ルールには策定された背景がある。なぜこのルールがあるか理解して、ルールを順守しよう。", "時間がかかるからはルール無視の理由にならない。時間がかからないような作業方法を確立し、それまではルールを守ろう。", "設備を止めずに作業をすることは危険。なぜ設備を止めるルールがあるかを理解してから作業を行おう。", "手間を惜しんで作業をすると事故となることがある。手順通りに作業し無事に家に帰ろう"],
["ルールは安全を確保するためにある事を認識し、違反を見つけたら他の作業者を守るために注意せよ", "あいまいな指示を受けた時はそのままにせず、完全に理解できるまで内容確認せよ", "ルール違反は事故を招く、自分だけでなく他人を守るため注意をしあう", "作業内容はしっかり報連相", "作業内容を理解していない人には、理解させた上で作業をさせよ", "新入社員は危険を実感できない事が多い。何故SOPの手順であるか原理から説明せよ", "ほんのちょっとが積み重なると大きな事故を招く、決められた手順は遵守させよ", "共同作業者の作業スキルを考え、スキルが低い人の動きも注意して作業せよ", "作業指示書は、作業内容、安全、作業者のスキルを考慮して確認せよ", "危険個所は関係者に周知せよ", "ヒヤリハットは労災防止への第一歩。必ず報告し、未然に労災を防ごう。", "かがんで通ること自体が不自然である。かがまないで通れる場所を通ろう。"],
["自己流で行っている作業には気がついていない危険あり。SOPを遵守せよ", "不慣れな作業は助っ人を用意してから作業開始せよ", "教育を受けていない作業は行わない", "新入社員にはスキルチェックを確認の上、スキルに応じて作業を行う", "作業に使用する道具についても機能を理解せよ", "保護具の必要性についてSOP確認せよ", "作業前にトラブル対応手順を確認せよ", "動かないと思うものが、もし動いたらどうなるか想定、安全装置を過信しない", "装置のどの部分に危険が潜んでいるか、仲間に確認してから作業せよ", "通常作業時も含めて、建屋内の危険個所を認識して作業せよ", "多くの動機器は、直ぐには止まらない。特性を理解してから作業を行おう。", "経験の少ない作業を行う時は、安全対策を再確認しよう。", "設備の構造、仕組みはどれも同じではない。作業対象をよく理解してから作業しよう。", "設備の動作順序を理解せずに作業を行うと動作に巻き込まれることがある。よく理解してから行おう。", "ケブラー手袋も万能ではない。刃に触れないような作業手順を組んでから作業しよう。", "重量物を取り扱う作業は予想以上に体に負担となる。作業頻度に応じ、的確な作業計画、手順を作り作業を行おう。", "定期的に作業手順の所以を学習し、疑問点は調査、修正していこう。", "トラブル対処法などを学んだうえで作業しよう。"],
["急いでいる時こそ作業手順・注意事項を理解せよ", "動かないと思うものが、もし動いたらどうなるか想定、安全装置を過信しない", "自分だけは大丈夫と思う事自体がリスクになる、仲間の安全も考えよう", "慌てるときほど、一息入れて安全確認せよ", "装置のどの部分に危険が潜んでいるか、仲間に確認してから作業せよ", "通常作業時も含めて、建屋内の危険個所を認識して作業せよ", "眠気がある時は作業しない、準備体操をする等、眠気を覚ましてから作業しよう", "重量物の下、設備の隙間ははさまれ危険個所であることを意識せよ", "注意表示を風景にしない、指差しして自分の身を守ろう", "疲労を感じるときは、小休憩を取って作業をしよう", "体調が悪い時は無理をせず、休みを取ろう", "周囲の安全を確認した上で、足元は必ず見よう。", "異常が発生した時の対応が決まっていない作業は、作業前に対応を確認しよう", "勤務終了間際は注意が散漫になる事がある。移動、行動は確認しながら行おう。", "設備の危険個所を確認してから、作業を始めよう。", "稼働している動機器付近の作業を続けると、いつかは巻き込まれる。停止して作業を行うように見直そう。", "不慣れな作業は、作業手順を理解し、異常時の対応も確認する", "作業の最後まで状態を確認し、KYを実施して行おう。", "ながら行動はやめ、一つのことに専念しよう。", "普段行っている作業でも、危険な行動になっていないか意識しよう", "一作業、一片付けを意識して行動しよう", "周囲の危険源を把握し、安全対策を行ってから作業を行おう。", "想定外の事象が起きた時は、いったん作業を止め、どうすれば安全に対処できるか確認してから行動しよう。", "違う設備には違うルールがあり、いつもと同じように行動することは危険。違いを理解してから行動しよう。"],
["共同作業者の安全も確保せよ", "共同作業者と呼吸を合わせ合図を取り合おう", "思い違いが事故を招く、合図は確実に伝えよ", "整理できていない状態は自分だけでなく他の作業者にも危険を招く。直ちに整理せよ", "整理整頓は安全の基本", "道具は定位置管理せよ", "立ち入り禁止区域は誰でも分かるようにせよ", "作業エリアの突起等、普段から身の回りの危険源に留意しよう", "注意表示は常に見えやすくせよ", "作業を同時に行う場合は、互いにどう干渉するかを考えてから行おう。", "二人作業では相方が思わぬ動きをすることがある。事前に作業内容について打ち合わせをしてから作業開始しよう。", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", "", ""],
["SOPの更新が遅れている場合、まずは上司に相談し、仮の作業指示書を発行してもらう", "作業性が悪いとの理由で保護具着用が義務付けられていない作業がある場合、まずは上司に相談し、安全最優先で作業方法の見直しをせよ", "何かを変更するときは今までの作業手順でよいかも確認せよ", "SOPが作成されていない作業がある場合、まずは上司に相談し、少頻度作業でも作業指示書或いはSOPを作成せよ", "安全対策が後回しになっている場合、まずは上司に相談し、職場の安全を最優先してもらう", "安全パトロールは、設備の異常、人への危険を見出す、大切な労災予防活動である事を認識せよ", "足場が不安定な場所での作業は見直しせよ", "注意表示は常に見え易くせよ", "警報は危険を知らせる重要な情報。いつもと同じと思わず、危険が無いか確認しよう。", "足場の凹凸は、転倒の危険有り。足場の凹凸は無くすようにしよう。", "過去の労災の対策は、意図も含めて伝承しよう。"],
["作業変更の際は上司に報連相する", "指示書からの変更がある場合は必ず届け出よ", "自分にとって些細な変更でも他の人に影響する可能性あり。些細なことでも連絡・相談せよ", "必要な変更は上司に相談。安全を評価の上変更せよ", "指示が曖昧な時は、確実に理解できるまで内容確認せよ", "安全カバーを開ける行為は、危険個所をむきだしにする事と認識せよ"]
];


    var image = document.getElementById("mainImage"); //イラスト
    var note = document.getElementById("note"); //
    var pn = document.getElementById("pn"); //正解の数
    var outline = document.getElementById("outline");
    var ad1 = document.getElementById("advice1");
    var mi = document.getElementById("miles");
    var st = document.getElementById("status");
    var points = document.getElementById("points");
    var miles = 0;
    var record = [];
    var db = [];
    var dl = database.length;
    var rank = 0;

    work1.addEventListener('change',changed);
     function changed(){
        //初期化
        db = [];
        record = [];
        miles = 0;
        note.style.display = "none";
        ad1.innerHTML = "";
        st.innerHTML = "";
        mi.innerHTML = "&nbsp" + miles +"miles";
        work1 = document.getElementById("work1").value;
        
        for(let i = 0; i < 10; i++){
            let el = document.getElementById("po" + i);
            el.classList.add("hidden");
        }

        for (let i = 0; i < dl; i++){
            db1 = [];                  
            key = database[i][0];
            key = key.split("_")[0];
            
            if(work1 == key){            
              db1 = [...database[i]];
              aso = 1;
              db1.push(aso);
              db.push(db1);
             } else {
              db1 = [...database[i]];
              aso = 0;
              db1.push(aso);
              db.push(db1);
             }
        }

        db.sort((a, b) => b[3] - a[3]);

        //work2 == key.split("_")[0]
        ln=db[rank][2];
        nullCount = ln.filter(item => item === "").length;
        ln1=ln.length-nullCount;
        var filename =db[rank][0] +'.jpg';
        var photo1 = filename;
        image.src = photo1;
        pn.innerHTML = "&nbsp" + "注意点の数:"+"&nbsp" + ln1 + "点";
        outline.innerHTML = "&nbsp" + db[rank][1];

        for(let i = 0; i < 10; i++){
            let el = document.getElementById("po" + i);
            el.innerHTML = "&nbsp" + db[rank][2][i][0];
        }

     } 

    image.addEventListener("click", function(event) {
        // 画像上のクリック座標を取得
        const rect = image.getBoundingClientRect();
        const x = event.clientX - rect.left;
        const y = event.clientY - rect.top;


        ln=db[rank][2]; //
        wt=db[rank][0]; //作業の種類（メインキー）
        nullCount = ln.filter(item => item === "").length;
        ln1=ln.length-nullCount;

        note.style.display = "none";

        let numStr = wt.split("_")[0];  // "_"で分割し、前半を取得
        let wt1 = parseInt(numStr); //作業番号の取得
        adl = KY_advices1[wt1].length;
        let adr = Math.floor(Math.random() * adl); //アドバイスの乱数

        ad1.innerHTML = KY_advices1[wt1][adr]; //アドバイス内容　表示

        
        // クリック位置が特定範囲内なら注意表示
        for (let i = 0; i < ln1; i++) {
  
            a1=db[rank][2][i][1][0];
            a2=db[rank][2][i][1][2];
            b1=db[rank][2][i][1][1];
            b2=db[rank][2][i][1][3];

             if (x >= a1 && x <= a2 && y >= b1 && y <= b2) {
                 ch=1;
                 let el = document.getElementById("po" + i);
                 note.style.left = (x + 10) + "px";
                 note.style.top = (y + 10) + "px";
                 note.style.display = "block";
                 note.textContent="⚠️ 注意点：" + db[rank][2][i][0];

                 if(record.includes(i)){
                    ch=0;
                 } else {
                          const sound = document.getElementById('coinSound');
                          sound.currentTime = 0; // 連打対応：音を最初から再生
                          sound.play();
                 }
                 miles = miles + 100/ln1*ch;
                 miles1 = Math.floor(miles);
                 mi.innerHTML = "&nbsp" + miles1 +"miles";
                 record.push(i);
                 el.classList.remove("hidden");

                 if(miles1 > 0 && miles1 < 50){
                    st.innerHTML = "Good!";
                 } else if(miles1 >= 50 && miles1 < 100){
                    st.innerHTML = "Great!";
                 } else if(miles1 >= 100){
                    st.innerHTML = "Perfect!";
                                
                    const sound = document.getElementById('perfect');
                          sound.currentTime = 0; // 連打対応：音を最初から再生
                          sound.play();

                 }

                 }
        }

    });

    const coords = document.getElementById("coords");
    const container = document.getElementById("imageContainer");

    image.addEventListener("mousemove", function(event) {
        const rect = image.getBoundingClientRect();
        const x = Math.round(event.clientX - rect.left);
        const y = Math.round(event.clientY - rect.top);

        // 表示を更新
        coords.textContent = `X: ${x}, Y: ${y}`;
        coords.style.left = (x + 10) + "px";
        coords.style.top = (y + 10) + "px";
        coords.style.display = "none"; //エディターモードoff
    });

    image.addEventListener("mouseleave", function() {
        coords.style.display = "none";
    });

    image.addEventListener("mouseenter", function() {
        coords.style.display = "block";
    });

    function reloadPage() {
      location.reload();
    }

     function next(){
        //次の場面表示
        rank = rank + 1;
        if(rank >= dl){
            rank = 0;
        };

        record = [];
        miles = 0;
        note.style.display = "none";
        ad1.innerHTML = "";
        st.innerHTML = "";
        mi.innerHTML = "&nbsp" + miles +"miles";
        //work1 = document.getElementById("work1").value;

        
        for(let i = 0; i < 10; i++){
            let el = document.getElementById("po" + i);
            el.classList.add("hidden");
        }

        ln=db[rank][2];
        nullCount = ln.filter(item => item === "").length;
        ln1=ln.length-nullCount;
        var filename =db[rank][0] +'.jpg';
        var photo1 = filename;
        image.src = photo1;
        pn.innerHTML = "&nbsp" + "注意点の数:"+"&nbsp" + ln1 + "点";
        outline.innerHTML = "&nbsp" + db[rank][1];

        for(let i = 0; i < 10; i++){
            let el = document.getElementById("po" + i);
            el.innerHTML = "&nbsp" + db[rank][2][i][0];
        }

        //作業の特定
        wt=db[rank][0]; //作業の種類（メインキー）
        let numStr = wt.split("_")[0];  // "_"で分割し、前半を取得
        let wt1 = parseInt(numStr); //作業番号の取得

        const select = document.getElementById("work1");
        const optionToSelect = [...select.options].find(opt => parseInt(opt.value) === wt1);
        if (optionToSelect) {
            optionToSelect.selected = true;
        }


     } 
    
    function previous(){
        //次の場面表示
        rank = rank - 1;
        if(rank < 0){
            rank = dl - 1;
        };

        record = [];
        miles = 0;
        note.style.display = "none";
        ad1.innerHTML = "";
        st.innerHTML = "";
        mi.innerHTML = "&nbsp" + miles +"miles";
        work1 = document.getElementById("work1").value;

        
        for(let i = 0; i < 10; i++){
            let el = document.getElementById("po" + i);
            el.classList.add("hidden");
        }

        ln=db[rank][2];
        nullCount = ln.filter(item => item === "").length;
        ln1=ln.length-nullCount;
        var filename =db[rank][0] +'.jpg';
        var photo1 = filename;
        image.src = photo1;
        pn.innerHTML = "&nbsp" + "注意点の数:"+"&nbsp" + ln1 + "点";
        outline.innerHTML = "&nbsp" + db[rank][1];

        for(let i = 0; i < 10; i++){
            let el = document.getElementById("po" + i);
            el.innerHTML = "&nbsp" + db[rank][2][i][0];
        }

        //作業の特定
        wt=db[rank][0]; //作業の種類（メインキー）
        let numStr = wt.split("_")[0];  // "_"で分割し、前半を取得
        let wt1 = parseInt(numStr); //作業番号の取得

        const select = document.getElementById("work1");
        const optionToSelect = [...select.options].find(opt => parseInt(opt.value) === wt1);
        if (optionToSelect) {
            optionToSelect.selected = true;
        }

     }


</script>

</body>
</html>
